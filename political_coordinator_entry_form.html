<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Coordinator Entry - EventLens</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
  <script>tailwind.config = { theme: { extend: { fontFamily: { sans: ['"Plus Jakarta Sans"', 'sans-serif'] } } } }</script>
  <style>
    body { background: radial-gradient(circle at top left, rgba(249, 115, 22, 0.15), transparent 50%), radial-gradient(circle at bottom right, rgba(234, 88, 12, 0.1), transparent 50%), #0f172a; color: #fff; }
    .glass { background: rgba(30, 41, 59, 0.85); backdrop-filter: blur(16px); border: 1px solid rgba(255, 255, 255, 0.1); box-shadow: 0 20px 40px rgba(0,0,0,0.4); }
    .input-group { position: relative; transition: transform 0.2s; }
    .input-field { width: 100%; background: rgba(15, 23, 42, 0.6); border: 1px solid rgba(148, 163, 184, 0.2); border-radius: 0.85rem; padding: 0.85rem 1rem 0.85rem 2.75rem; color: white; transition: all 0.3s; outline: none; }
    .input-field:focus { border-color: #f97316; box-shadow: 0 0 0 4px rgba(249, 115, 22, 0.15); }
    .input-icon { position: absolute; left: 1rem; top: 50%; transform: translateY(-50%); color: #94a3b8; pointer-events: none; }
    .input-field:focus ~ .input-icon { color: #f97316; }
    .btn-gradient { background: linear-gradient(135deg, #f97316, #ea580c); transition: all 0.3s; }
    .btn-gradient:hover { transform: translateY(-2px); box-shadow: 0 10px 20px -5px rgba(249, 115, 22, 0.4); }
    .section-title { font-size: 0.8rem; text-transform: uppercase; letter-spacing: 1px; color: #94a3b8; margin-top: 1rem; margin-bottom: 0.5rem; font-weight: 700; }
  </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">
  <div class="glass w-full max-w-lg rounded-3xl p-6 md:p-8 relative overflow-hidden">
    <div class="absolute top-0 left-1/2 -translate-x-1/2 w-32 h-1 bg-orange-500 rounded-b-full shadow-[0_0_20px_rgba(249,115,22,0.6)]"></div>
    
    <div class="text-center mb-6 mt-2">
      <div class="inline-flex items-center justify-center w-14 h-14 rounded-2xl bg-orange-500/10 text-orange-500 mb-4 ring-1 ring-orange-500/20">
        <i class="fa-solid fa-users-gear text-2xl"></i>
      </div>
      <h1 class="text-2xl font-bold">Coordinator Entry</h1>
      <p class="text-slate-400 text-sm mt-1">Management Team Details</p>
    </div>

    <form id="f" class="space-y-3">
      
      <!-- Basic Details -->
      <div class="input-group">
        <input id="program_name" type="text" placeholder="कार्यक्रम का नाम *" required class="input-field" />
        <i class="fa-solid fa-bullhorn input-icon"></i>
      </div>

      <div class="input-group">
        <input id="district" type="text" placeholder="जिला *" required class="input-field" />
        <i class="fa-solid fa-map-location-dot input-icon"></i>
      </div>

      <div class="grid grid-cols-2 gap-3">
        <div class="input-group"><input id="vidhansabha" type="text" placeholder="विधानसभा" class="input-field" /><i class="fa-solid fa-landmark input-icon"></i></div>
        <div class="input-group"><input id="mandal" type="text" placeholder="मंडल" class="input-field" /><i class="fa-solid fa-sitemap input-icon"></i></div>
      </div>

      <!-- Convenor -->
      <div class="section-title">संयोजक (Convenor)</div>
      <div class="grid grid-cols-2 gap-3">
        <div class="input-group"><input id="convenor_name" type="text" placeholder="नाम *" required class="input-field" /><i class="fa-solid fa-user input-icon"></i></div>
        <div class="input-group"><input id="convenor_mobile" type="tel" placeholder="मोबाइल *" maxlength="10" required class="input-field" /><i class="fa-solid fa-phone input-icon"></i></div>
      </div>

      <!-- Co-Convenor 1 -->
      <div class="section-title">सह संयोजक 1 (Co-Convenor)</div>
      <div class="grid grid-cols-2 gap-3">
        <div class="input-group"><input id="co_convenor1_name" type="text" placeholder="नाम" class="input-field" /><i class="fa-solid fa-user-plus input-icon"></i></div>
        <div class="input-group"><input id="co_convenor1_mobile" type="tel" placeholder="मोबाइल" maxlength="10" class="input-field" /><i class="fa-solid fa-phone input-icon"></i></div>
      </div>

      <!-- Co-Convenor 2 -->
      <div class="section-title">सह संयोजक 2 (Co-Convenor)</div>
      <div class="grid grid-cols-2 gap-3">
        <div class="input-group"><input id="co_convenor2_name" type="text" placeholder="नाम" class="input-field" /><i class="fa-solid fa-user-plus input-icon"></i></div>
        <div class="input-group"><input id="co_convenor2_mobile" type="tel" placeholder="मोबाइल" maxlength="10" class="input-field" /><i class="fa-solid fa-phone input-icon"></i></div>
      </div>

      <button id="submitBtn" type="submit" class="w-full btn-gradient text-white font-bold py-4 rounded-xl shadow-lg mt-6 flex items-center justify-center gap-2 text-lg">
        <span>Save Coordinators</span> <i class="fa-solid fa-check-circle"></i>
      </button>
    </form>
    <div id="statusBox" class="hidden mt-4 p-4 rounded-xl text-sm text-center font-medium border border-transparent"></div>
  </div>

<script>
    (() => {
        const API_ID = 'vxid0yoovj'; const REGION = 'ap-south-1'; const FORM_TYPE = 'coordinator_entry';
        const FIELD_IDS = [
            'program_name','district','vidhansabha','mandal',
            'convenor_name','convenor_mobile',
            'co_convenor1_name','co_convenor1_mobile',
            'co_convenor2_name','co_convenor2_mobile'
        ];
        const $ = (id) => document.getElementById(id);
        const qs = (n) => { try{ return (new URL(window.location.href)).searchParams.get(n)||''; }catch(e){ return ''; } };
        const token = qs('token'); const cidParam = (qs('cid') || qs('collection_id') || qs('id')).trim(); const isPublicMode = () => !!token;

        function showStatus(msg, isErr=false){
            const b=$('statusBox');
            b.classList.remove('hidden', 'bg-emerald-500/10', 'text-emerald-400', 'border-emerald-500/20', 'bg-red-500/10', 'text-red-400', 'border-red-500/20');
            b.classList.add(isErr ? 'bg-red-500/10' : 'bg-emerald-500/10');
            b.classList.add(isErr ? 'text-red-400' : 'text-emerald-400');
            b.classList.add(isErr ? 'border-red-500/20' : 'border-emerald-500/20');
            b.innerHTML = msg;
        }

        async function apiCall(action, payload, auth=false){
            const base = `https://${API_ID}.execute-api.${REGION}.amazonaws.com/prod${isPublicMode()?'/political/public/forms':'/political/forms'}`;
            const headers = {'Content-Type':'application/json'};
            if(auth){ const jwt = localStorage.getItem('idToken') || localStorage.getItem('accessToken'); if(!jwt) throw new Error('Auth Missing'); headers['Authorization'] = 'Bearer '+jwt; }
            const res = await fetch(base, { method:'POST', headers, body:JSON.stringify({action, payload}) });
            const data = await res.json();
            if(!res.ok) throw new Error(data.message || data.error || 'API Error');
            return data;
        }

        $('f').addEventListener('submit', async (e)=>{
            e.preventDefault();
            const btn = $('submitBtn'); const ot = btn.innerHTML; btn.disabled=true; btn.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> Saving...'; showStatus('');
            try {
                const data = {}; for(const id of FIELD_IDS) data[id] = $(id).value.trim();
                
                // NO PHOTO UPLOAD LOGIC
                let res;
                if(isPublicMode()){ 
                    res = await apiCall('public_create_entry', { token, form_type: FORM_TYPE, file_kind:'none', payload: data }); 
                } else { 
                    if(!cidParam) throw new Error('Missing Collection ID'); 
                    res = await apiCall('create_entry', { collection_id: cidParam, form_type: FORM_TYPE, file_kind:'none', payload: data }, true); 
                }

                const af = isPublicMode() ? 'public_finalize_entry' : 'finalize_entry';
                await apiCall(af, { finalize_token: res.finalize_token, entry_id: res.entry_id }, !isPublicMode());
                
                showStatus('✅ Coordinators Saved Successfully!', false); $('f').reset();
            } catch(err) { showStatus('❌ ' + err.message, true); } finally { btn.disabled=false; btn.innerHTML = ot; }
        });
    })();
</script>
</body>
</html>
