<!DOCTYPE html>

<!-- EventLens build: 2026-02-17 04:08:31 -->
<html lang="hi">
<head>
  <meta name="mobile-web-app-capable" content="yes"/>
<meta name="apple-mobile-web-app-capable" content="yes"/>
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
<meta name="theme-color" content="#0f172a"/>
<meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mandal Reporting - EventLens</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>

    // === EventLens Admin Console Live Preview Bridge (2026-02-17) ===
    (function() {
      const __ft = (typeof FORM_TYPE !== "undefined") ? FORM_TYPE : ((typeof FORM_TYPE_RAW !== "undefined") ? FORM_TYPE_RAW : "");
      const __cid = (qs("cid") || qs("collection_id") || qs("cid") || "").trim();

      function __applyPreview(payload) {
        try {
          const fb = window.__EL_PREVIEW_FALLBACKS || {};
          applyBrandingFromConfig(payload, __ft, fb.title || "", fb.subtitle || "", fb.tagline || "", fb.iconId || "default-icon");

          // Keep tagline visibility consistent
          const tg = document.getElementById("org-tagline");
          if (tg) {
            if ((tg.textContent || "").trim()) tg.classList.remove("hidden");
            else tg.classList.add("hidden");
          }
        } catch(e) {}
      }

      window.addEventListener("message", (ev) => {
        const d = ev && ev.data;
        if (!d || typeof d !== "object") return;
        if (d.type !== "EL_PREVIEW_SETTINGS") return;
        if (d.form_type && __ft && d.form_type !== __ft) return;
        if (d.cid && __cid && d.cid !== __cid) return;
        __applyPreview(d.payload || {});
      });

      try {
        if (window.parent && window.parent !== window) {
          window.parent.postMessage({ type: "EL_PREVIEW_READY", cid: __cid, form_type: __ft }, "*");
        }
      } catch(e) {}

      window.__EL_applyPreviewSettings = __applyPreview;
    })();

</script>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { sans: ['"Plus Jakarta Sans"', 'sans-serif'] }
        }
      }
    }
  </script>
  <style>
    :root {
      --c1: #f97316; /* primary */
      --c2: #ef4444; /* secondary */
      --bgimg: none;
    }
    body {
      background:
        radial-gradient(circle at top left, rgba(249, 115, 22, 0.14), transparent 50%),
        radial-gradient(circle at bottom right, rgba(234, 88, 12, 0.10), transparent 50%),
        linear-gradient(180deg, rgba(2, 6, 23, 0.92), rgba(2, 6, 23, 0.98)),
        var(--bgimg);
      background-size: cover;
      background-attachment: fixed;
      color: #fff;
    }
    .glass {
      background: rgba(30, 41, 59, 0.75);
      backdrop-filter: blur(16px);
      border: 1px solid rgba(255, 255, 255, 0.10);
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.40);
    }
    .input-field {
      background: rgba(15, 23, 42, 0.55);
      border: 1px solid rgba(255, 255, 255, 0.10);
      color: white;
      transition: all 0.25s ease;
    }
    .input-field:focus {
      border-color: var(--c1);
      box-shadow: 0 0 0 2px rgba(249, 115, 22, 0.18);
      outline: none;
    }
    .input-field:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      background: rgba(15, 23, 42, 0.35);
    }
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: #0f172a; }
    ::-webkit-scrollbar-thumb { background: #334155; border-radius: 3px; }

    .brand-text {
      background-clip: text;
      -webkit-background-clip: text;
      color: transparent;
      background-image: linear-gradient(to right, var(--c1), var(--c2));
    }
    .brand-bg { background-image: linear-gradient(to right, var(--c1), var(--c2)); }
    .brand-ring { box-shadow: 0 0 0 2px rgba(249, 115, 22, 0.16); }
  

    /* === EventLens Embed/Light/Preview Patch (2026-02-17) === */
    html, body { height: 100%; }
    body.el-embed {
      margin: 0 !important;
      padding: 0 !important;
      overflow-x: hidden;
      background-attachment: scroll !important;
    }
    body.el-embed [class*="max-w-"] {
      max-width: 100% !important;
    }
    body.el-embed img {
      max-width: 100% !important;
      height: auto !important;
    }
    /* Light mode (optional via ?theme=light) */
    body.el-light {
      color: #0f172a !important;
      background: #f8fafc !important;
    }
    body.el-light .glass {
      background: rgba(255, 255, 255, 0.88) !important;
      border: 1px solid rgba(15, 23, 42, 0.10) !important;
      box-shadow: 0 14px 28px rgba(2, 6, 23, 0.10) !important;
    }
    body.el-light .input-field {
      background: rgba(255, 255, 255, 0.96) !important;
      color: #0f172a !important;
      border: 1px solid rgba(15, 23, 42, 0.18) !important;
    }
    body.el-light .input-field::placeholder {
      color: rgba(15, 23, 42, 0.45) !important;
    }


/* ===== EventLens: Light mode visibility fixes (auto) ===== */
body.mode-light{ color:#0f172a !important; }
body.mode-light .card,
body.mode-light .panel,
body.mode-light .section,
body.mode-light .container,
body.mode-light .wrap,
body.mode-light .box{
  background: rgba(255,255,255,.92) !important;
  border-color: rgba(15,23,42,.14) !important;
}
body.mode-light input,
body.mode-light select,
body.mode-light textarea{
  background: rgba(255,255,255,.96) !important;
  color:#0f172a !important;
  border-color: rgba(15,23,42,.18) !important;
}
body.mode-light input::placeholder,
body.mode-light textarea::placeholder{
  color: rgba(15,23,42,.45) !important;
}
body.mode-light label,
body.mode-light .label{ color: rgba(15,23,42,.85) !important; }
body.mode-light .muted,
body.mode-light .hint,
body.mode-light .help{ color: rgba(15,23,42,.65) !important; }
body.mode-light select option{ background:#ffffff; color:#0f172a; }
/* ===== /EventLens: Light mode visibility fixes ===== */

/* Mobile Responsive */
@media(max-width:600px){
  input,select,textarea{font-size:16px!important;min-height:44px;}
  .btn,button[type=submit]{width:100%;padding:14px!important;font-size:15px!important;}
  .container,.card,.section-card{padding:12px!important;border-radius:12px!important;}
  .grid{grid-template-columns:1fr!important;}
  .resp-grid{grid-template-columns:1fr!important;}
}
body{overflow-x:hidden;}
</style>
</head>
    <body class="min-h-screen flex items-center justify-center p-4 font-sans mode-dark">

    <div class="w-full max-w-lg glass rounded-2xl p-6 relative overflow-hidden transition-all duration-500" id="main-container">
    <div class="absolute top-0 left-0 w-full h-1 brand-bg"></div>

    <div id="header-image" class="hidden w-full h-24 rounded-xl mb-4 bg-slate-800/40 border border-white/5 overflow-hidden bg-cover bg-center"></div>

    <div class="text-center mb-6" id="form-header">
        <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-white/5 text-orange-500 mb-3 overflow-hidden border border-white/10">
            <i id="default-icon" class="fa-solid fa-flag text-2xl"></i>
            <img id="custom-logo" src="" class="w-full h-full object-cover hidden" alt="logo">
        </div>
        <h1 id="org-name" class="text-2xl font-extrabold brand-text">कार्यक्रम रिपोर्टिंग</h1>
        <p id="org-subtitle" class="text-slate-300/80 text-xs mt-1">Program Reporting</p>
        <p id="org-tagline" class="text-slate-400 text-[11px] mt-2 hidden"></p>
    </div>

      <form id="f" class="space-y-4">

        <div>
          <label class="block text-xs font-medium text-slate-300/80 mb-1">Level</label>
          <div class="relative">
            <select id="level" class="w-full rounded-lg px-3 py-2.5 text-sm input-field appearance-none">
              <option value="district">District</option>
              <option value="vidhansabha">Vidhan Sabha</option>
              <option value="mandal" selected>Mandal</option>
            </select>
            <i class="fa-solid fa-chevron-down absolute right-3 top-3.5 text-slate-500 text-xs pointer-events-none"></i>
          </div>
          <p id="level-note" class="text-[10px] text-slate-400 mt-1"></p>
        </div>

        <div>
          <label class="block text-xs font-medium text-slate-300/80 mb-1">कार्यक्रम का नाम</label>
          <div class="relative">
            <select id="program_name" class="w-full rounded-lg px-3 py-2.5 text-sm input-field appearance-none" required>
              <option value="">— कार्यक्रम चुनें —</option>
              <option value="कार्यक्रम-1">कार्यक्रम-1</option>
            </select>
            <i class="fa-solid fa-chevron-down absolute right-3 top-3.5 text-slate-500 text-xs pointer-events-none"></i>
          </div>
        </div>

        <div id="wrap-district">
          <label class="block text-xs font-medium text-slate-300/80 mb-1">जिला</label>
          <select id="district" class="w-full rounded-lg px-3 py-2.5 text-sm input-field">
            <option value="">— जिला चुनें —</option>
          </select>
        </div>

        <div class="grid grid-cols-2 gap-4">
          <div id="wrap-vidhansabha">
            <label class="block text-xs font-medium text-slate-300/80 mb-1">विधानसभा</label>
            <select id="vidhansabha" class="w-full rounded-lg px-3 py-2.5 text-sm input-field" disabled>
              <option value="">— पहले जिला चुनें —</option>
            </select>
          </div>
          <div id="wrap-mandal">
            <label class="block text-xs font-medium text-slate-300/80 mb-1">मंडल</label>
            <select id="mandal" class="w-full rounded-lg px-3 py-2.5 text-sm input-field" disabled>
              <option value="">— पहले विधानसभा चुनें —</option>
            </select>
          </div>
        </div>

        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="block text-xs font-medium text-slate-300/80 mb-1">रिपोर्टर नाम</label>
            <input type="text" id="reporter_name" class="w-full rounded-lg px-3 py-2.5 text-sm input-field" placeholder="Name" required>
          </div>
          <div>
            <label class="block text-xs font-medium text-slate-300/80 mb-1">मोबाइल</label>
            <input type="tel" id="reporter_mobile" class="w-full rounded-lg px-3 py-2.5 text-sm input-field" placeholder="10-digit" inputmode="numeric" pattern="[0-9]{10}">
          </div>
        </div>

        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="block text-xs font-medium text-slate-300/80 mb-1">तारीख</label>
            <input type="date" id="report_date" class="w-full rounded-lg px-3 py-2.5 text-sm input-field" required>
          </div>
          <div>
            <label class="block text-xs font-medium text-slate-300/80 mb-1">उपस्थिति (संख्या)</label>
            <input type="number" id="attendance_count" class="w-full rounded-lg px-3 py-2.5 text-sm input-field" placeholder="0">
          </div>
        </div>

        <div>
          <label class="block text-xs font-medium text-slate-300/80 mb-1">रिपोर्ट / विवरण</label>
          <textarea id="report_summary" rows="4" class="w-full rounded-lg px-3 py-2.5 text-sm input-field" placeholder="Report details" required></textarea>
        </div>

        <!-- Multi Photo -->
        <div class="space-y-2">
          <div class="flex items-center justify-between">
            <label class="block text-xs font-semibold text-slate-200 uppercase tracking-wider">फोटो (Multiple - Optional)</label>
            <button type="button" id="add-photo-btn" class="text-xs bg-white/10 hover:bg-white/15 border border-white/10 px-3 py-1.5 rounded-lg">
              <i class="fa-solid fa-plus mr-1"></i> Add
            </button>
          </div>

          <input type="file" id="photos" accept="image/*" class="hidden" multiple>

          <div id="photo-hint" class="text-[11px] text-slate-400 border border-white/10 bg-white/5 rounded-xl p-3">
            आप एक से अधिक फोटो जोड़ सकते हैं। (Max 10)
          </div>

          <div id="photo-grid" class="grid grid-cols-3 gap-3"></div>
        </div>

        <button type="submit" id="submitBtn" class="w-full brand-bg text-white font-extrabold py-3 rounded-xl shadow-lg shadow-orange-500/20 transition-all active:scale-[0.98] flex items-center justify-center gap-2 hover:opacity-95">
          <span>सुरक्षित करें (Save)</span><i class="fa-solid fa-paper-plane text-xs"></i>
        </button>
      </form>

    <div id="status" class="mt-4 text-center text-xs font-medium hidden"></div>
    <div class="mt-4 text-center text-[11px] text-slate-400/80">
      <span id="footer-text"></span>
    </div>
</div>

    <!-- SUCCESS SCREEN -->
<div id="success-screen" class="hidden w-full max-w-lg glass rounded-2xl p-8 text-center flex flex-col items-center justify-center min-h-[420px]">
    <div class="w-20 h-20 bg-emerald-500/15 text-emerald-400 rounded-full flex items-center justify-center mb-6 text-4xl shadow-lg shadow-emerald-500/10 border border-emerald-500/20">
        <i class="fa-solid fa-check"></i>
    </div>
    <h2 class="text-2xl font-extrabold text-white mb-2">धन्यवाद!</h2>
    <p id="success-msg" class="text-slate-200/90 mb-8 leading-relaxed">रिपोर्टिंग सेव हो गई है।</p>
    <button onclick="window.location.reload()" class="px-6 py-2.5 bg-white/10 hover:bg-white/15 border border-white/10 rounded-lg text-sm text-white transition">
        <i class="fa-solid fa-rotate-right mr-2"></i> नया फॉर्म
    </button>
</div>

    <script>
    // ===============================
// COMMON CONFIG & UTILS
// ===============================
const API_ID = "vxid0yoovj";
const AWS_REGION = "ap-south-1";
const BASE_URL = `https://${API_ID}.execute-api.${AWS_REGION}.amazonaws.com/prod`;

const $ = (id) => document.getElementById(id);
const qs = (n) => { try { return (new URL(window.location.href)).searchParams.get(n) || ""; } catch (e) { return ""; } };

  // === Embed / Preview flags (2026-02-17) ===
  const __EL_PREVIEW_MODE = (qs("preview") === "1");
  const __EL_EMBED_MODE = (qs("embed") === "1") || (window.self !== window.top);
  const __EL_THEME_MODE = (qs("theme") || "").toLowerCase();
  try {
    if (__EL_EMBED_MODE) document.body.classList.add("el-embed");
    if (__EL_PREVIEW_MODE) document.body.classList.add("el-preview");
    if (__EL_THEME_MODE === "light") document.body.classList.add("el-light");
  } catch(e) {}


const token = (qs("token") || "").trim();
const cidParam = (qs("cid") || qs("collection_id") || qs("id") || "").trim();
const levelParam = (qs("level") || "").trim().toLowerCase(); // district | vidhansabha | mandal
const debug = (qs("debug") || "").trim() === "1";

function isPublicMode() { return !!token; }




function showStatus(msg, isError) {
  const el = $("status");
  if (!el) return;
  el.classList.remove("hidden","text-green-400","text-red-400");
  el.classList.add(isError ? "text-red-400" : "text-green-400");
  el.textContent = msg || "";
  if (!msg) el.classList.add("hidden");
}

async function apiCall(action, payload) {
  // IMPORTANT: use same endpoint as admin to avoid CORS/preflight issues
  const url = `${BASE_URL}/political/forms`;
  const res = await fetch(url, {
    method: "POST",
    cache: "no-store",
    body: JSON.stringify({ action, payload: payload || {} })
  });
  const text = await res.text();
  let data = {};
  try { data = JSON.parse(text); } catch (e) { data = { message: text || "Invalid JSON" }; }
  if (!res.ok) throw new Error(data.message || data.error || `HTTP ${res.status}`);
  return data;
}

function safeStr(v) { return (v === null || v === undefined) ? "" : String(v); }



function isPresignedUrl(u) {
  // AWS S3 presigned URLs include X-Amz-* query params; adding our own query breaks the signature
  return /[?&]x-amz-/i.test(u) || /[?&]X-Amz-/i.test(u) || /X-Amz-Signature/i.test(u) || /X-Amz-Algorithm/i.test(u) || /X-Amz-Credential/i.test(u);
}

function cacheBust(url, ver) {
  const u = safeStr(url || "").trim();
  if (!u) return "";
  // Never append cache-bust to presigned URLs (it invalidates the signature and causes ORB/403 XML)
  if (isPresignedUrl(u)) return u;
  const v = safeStr(ver || "").trim();
  if (!v) return u;
  const sep = u.includes("?") ? "&" : "?";
  return u + sep + "v=" + encodeURIComponent(v);
}

function setThemeVars(c1, c2) {
  if (c1) document.documentElement.style.setProperty("--c1", c1);
  if (c2) document.documentElement.style.setProperty("--c2", c2);
}

function setBackgroundImage(url, ver) {
  const finalUrl = cacheBust(url, ver);
  if (!finalUrl) {
    document.documentElement.style.setProperty("--bgimg", "none");
    document.body.style.backgroundImage = "none";
    return;
  }
  const testImg = new Image();
  testImg.onload = () => {
    document.documentElement.style.setProperty("--bgimg", `url('${finalUrl}')`);
    document.body.style.backgroundImage = `url('${finalUrl}')`;
    document.body.style.backgroundSize = "cover";
    document.body.style.backgroundPosition = "center";
    document.body.style.backgroundAttachment = "fixed";
  };
  testImg.onerror = () => {
    document.documentElement.style.setProperty("--bgimg", "none");
    document.body.style.backgroundImage = "none";
  };
  testImg.src = finalUrl;
}
async function sha256Hex(file) {
  const buffer = await file.arrayBuffer();
  const hashBuffer = await crypto.subtle.digest("SHA-256", buffer);
  return Array.from(new Uint8Array(hashBuffer)).map(b => b.toString(16).padStart(2,'0')).join('');
}

async function uploadToS3(url, file) {
  await fetch(url, { method: "PUT", body: file, headers: { "Content-Type": file.type || "application/octet-stream" } });
}

function mergeObj(a, b) {
  const out = Object.assign({}, a || {});
  Object.keys(b || {}).forEach(k => {
    if (b[k] && typeof b[k] === "object" && !Array.isArray(b[k])) out[k] = mergeObj(out[k], b[k]);
    else out[k] = b[k];
  });
  return out;
}

// ===============================
// BRANDING + PROGRAMS + FIXED LEVEL
// ===============================
async function loadRemoteConfig(formType) {
  try {
    const payload = isPublicMode()
      ? { cid: cidParam, collection_id: cidParam, token, form_type: formType, _ts: Date.now() }
      : { collection_id: cidParam, form_type: formType, _ts: Date.now() };

    const action = isPublicMode() ? "public_get_config" : "admin_get_config";
    const res = await apiCall(action, payload);
    return res || null; // keep full response (settings/config/form)
  } catch (e) {
    if (debug) console.log("config load failed", e);
    return null;
  }
}

function applyBrandingFromConfig(cfgOrResp, formType, fallbackTitle, fallbackSubtitle, fallbackTagline, defaultIconId) {
  const obj = cfgOrResp || {};

  // -------- NEW response shape support (preferred) --------
  const defaultsNode = (obj.settings && obj.settings.defaults) || (obj.config && obj.config.defaults) || null;
  const globalNode = (obj.settings && obj.settings.global) || (obj.config && obj.config.global) || null;

  // Form node
  const ft = formType || obj.form_type || (typeof FORM_TYPE !== "undefined" ? FORM_TYPE : "");
  const formNode =
    (obj.form && typeof obj.form === "object" && (!obj.form_type || obj.form_type === ft)) ? obj.form :
    (obj.settings && obj.settings.forms && obj.settings.forms[ft]) ? obj.settings.forms[ft] :
    (obj.config && obj.config.forms && obj.config.forms[ft]) ? obj.config.forms[ft] :
    null;

  // If we have new nodes, apply using them
  if (defaultsNode || globalNode || formNode) {
    const branding = (formNode && formNode.branding) || (defaultsNode && defaultsNode.branding) || {};
    const theme = (globalNode && globalNode.theme) || {};

    const title = safeStr((formNode && formNode.title) || fallbackTitle || "EventLens Form");
    const subtitle = safeStr((formNode && formNode.subtitle) || fallbackSubtitle || "");
    const tagline = safeStr((formNode && formNode.tagline) || branding.tagline || fallbackTagline || "");
    const footerText = safeStr((globalNode && globalNode.tagline) || branding.footer_text || "Powered by EventLens");

    // Signed URLs from backend (preferred)
    const logoUrl = safeStr((formNode && formNode.logo_url) || (branding.logo && branding.logo.url) || branding.logo_url || "");
    const headerUrl = safeStr((formNode && formNode.header_url) || (branding.header && branding.header.url) || branding.header_image_url || "");
    const bgUrl = safeStr((formNode && formNode.background_url) || (branding.background && branding.background.url) || branding.background_image_url || "");

    // Cache bust (use updated_at if present, else Date.now)
    const ver = safeStr(obj.updated_at_ms || (globalNode && globalNode.updated_at_ms) || Date.now());

    if ($("org-name")) $("org-name").textContent = title;
    if ($("org-subtitle")) $("org-subtitle").textContent = subtitle;
    if ($("org-tagline")) $("org-tagline").textContent = tagline;
    if ($("footer-text")) $("footer-text").textContent = footerText;

    // Theme colors -> our CSS uses --c1/--c2
    const primary = safeStr(branding.color1 || theme.primary || "#f97316");
    const secondary = safeStr(branding.color2 || theme.secondary || "#ef4444");
    setThemeVars(primary, secondary);
    setBackgroundImage(bgUrl, ver);

    // Logo
    const logoEl = $("custom-logo");
    const iconEl = $(defaultIconId);
    const logoFinal = cacheBust(logoUrl, ver);
    if (logoEl && logoFinal) {
      logoEl.src = logoFinal;
      logoEl.classList.remove("hidden");
      if (iconEl) iconEl.classList.add("hidden");
      try { logoEl.onerror = () => { logoEl.classList.add("hidden"); if (iconEl) iconEl.classList.remove("hidden"); }; } catch(e) {}
    } else {
      if (logoEl) logoEl.classList.add("hidden");
      if (iconEl) iconEl.classList.remove("hidden");
    }

    // Header
    const headerWrap = $("header-wrap");
    const headerEl = $("header-image");
    const headerFinal = cacheBust(headerUrl, ver);
    if (headerWrap && headerEl && headerFinal) {
      headerEl.src = headerFinal;
      headerWrap.classList.remove("hidden");
      try { headerEl.onerror = () => { headerWrap.classList.add("hidden"); }; } catch(e) {}
    } else if (headerWrap) {
      headerWrap.classList.add("hidden");
    }

    return;
  }

  // -------- OLD config shape fallback --------
  const globalBrand = (obj && obj.branding && obj.branding.global) ? obj.branding.global : {};
  const perForm = (obj && obj.branding && obj.branding.forms && obj.branding.forms[formType]) ? obj.branding.forms[formType] : {};
  const brand = mergeObj(globalBrand, perForm);

  const title = brand.title || fallbackTitle || "EventLens Form";
  const subtitle = brand.subtitle || fallbackSubtitle || "";
  const tagline = brand.tagline || fallbackTagline || "";
  const logoUrl = brand.logo_url || "";
  const headerImg = brand.header_image_url || "";
  const footerText = brand.footer_text || "";
  const bgImg = brand.background_image_url || "";
  const ver = (obj && (obj.updated_at_ms || obj.updatedAtMs || obj.updated_at_iso)) || Date.now();

  if ($("org-name")) $("org-name").textContent = title;
  if ($("org-subtitle")) $("org-subtitle").textContent = subtitle;
  if ($("org-tagline")) $("org-tagline").textContent = tagline;
  if ($("footer-text")) $("footer-text").textContent = footerText;

  setThemeVars(brand.theme_primary, brand.theme_secondary);
  setBackgroundImage(bgImg, ver);

  const logoEl = $("custom-logo");
  const iconEl = $(defaultIconId);
  const logoFinal = cacheBust(logoUrl, ver);
  if (logoEl && logoFinal) {
    logoEl.src = logoFinal;
    logoEl.classList.remove("hidden");
    if (iconEl) iconEl.classList.add("hidden");
    try { logoEl.onerror = () => { logoEl.classList.add("hidden"); if (iconEl) iconEl.classList.remove("hidden"); }; } catch(e) {}
  } else {
    if (logoEl) logoEl.classList.add("hidden");
    if (iconEl) iconEl.classList.remove("hidden");
  }
  const headerWrap = $("header-wrap");
  const headerEl = $("header-image");
  const headerFinal = cacheBust(headerImg, ver);
  if (headerWrap && headerEl && headerFinal) {
    headerEl.src = headerFinal;
    headerWrap.classList.remove("hidden");
    try { headerEl.onerror = () => { headerWrap.classList.add("hidden"); }; } catch(e) {}
  } else if (headerWrap) {
    headerWrap.classList.add("hidden");
  }
}

function fillProgramNames(cfg, selectId) {
  const sel = $(selectId);
  if (!sel) return;
  const list = (cfg && (cfg.programs || (cfg.data && cfg.data.programs))) || [];
  const programs = Array.isArray(list) ? list : [];
  if (!programs.length) return;

  sel.innerHTML = '<option value="">— कार्यक्रम चुनें —</option>';
  programs.forEach((p) => {
    const v = safeStr(p).trim();
    if (!v) return;
    const opt = document.createElement("option");
    opt.value = v;
    opt.textContent = v;
    sel.appendChild(opt);
  });
}

function getFixedLevel(cfg, formType) {
  const fixed = (cfg && cfg.fixed_levels) ? cfg.fixed_levels : (cfg && cfg.data && cfg.data.fixed_levels) ? cfg.data.fixed_levels : {};
  if (fixed && fixed[formType]) return String(fixed[formType]).toLowerCase();
  return "";
}
    const FORM_TYPE = "mandal_reporting";
    const FIELD_IDS = ["level","program_name","district","vidhansabha","mandal","reporter_name","reporter_mobile","report_date","attendance_count","report_summary"];

    const DISTRICT_DATA = {
  "मुरैना": {
    "3. सबलगढ़": [
      "सबलगढ़ नगर",
      "सबलगढ़ गामीण",
      "नेपरी",
      "टेंटरा नया",
      "रामपुर कलां नया"
    ],
    "4. जौरा": [
      "कैलारस",
      "जौरा नगर",
      "जौरा ग्रामीण",
      "पहाडगढ़",
      "सरसैनी"
    ],
    "5. सुमावली": [
      "सुमावली",
      "छैरा",
      "मुंगावली",
      "बागचीनी",
      "मुरैना गा्रमीण"
    ],
    "6. मुरैना": [
      "मुरैना पूर्व",
      "मुरैना पश्चिम",
      "मुरैना दक्षिण",
      "बानमौर",
      "रिठौराकलाॅ",
      "जडेरूआ नया"
    ],
    "7. दिमनी": [
      "दिमनी",
      "सिहोनियां",
      "जीगनी",
      "थरा",
      "नावली बड़ागांव नया"
    ],
    "8. अम्बाह अजा": [
      "अम्बाह नगर",
      "अम्बाह ग्रामीण",
      "पोरसा नगर",
      "पोरसा ग्रामीण",
      "नगरा"
    ]
  },
  "भिण्ड": {
    "9. अटेर": [
      "अटेर",
      "फूफ",
      "पीपरी",
      "सुरपुरा",
      "सरायघार नया",
      "जवासा नया"
    ],
    "10. भिण्ड": [
      "भिण्ड गा्रमीण",
      "महाराणा प्रताप",
      "बनखण्डेश्वर",
      "सुभाषचंद्र बोस",
      "उमरी ,नयागांव",
      "उमरी अकोड़ा नया"
    ],
    "11. लहार": [
      "लहार",
      "आलमपुर",
      "दबोह",
      "असवार",
      "मिहोना",
      "मछण्ड"
    ],
    "12. मेहगांव": [
      "मेहगांव",
      "आमायन",
      "रौन",
      "गोरमी",
      "सोनी",
      "दंदरौआ"
    ],
    "13. गोहद अजा": [
      "गोहद नगर",
      "गोहद गा्रमीण",
      "मौ",
      "चितौरा",
      "मालनपुर नया"
    ]
  },
  "दतिया": {
    "20. सेवढ़ा": [
      "सेवढ़ा नगर",
      "सेवढ़ा ग्रामीण (बअुआपुरा)",
      "इन्दरगढ़ नगर",
      "इन्दरगढ़ ग्रामीण",
      "थरेट नया"
    ],
    "21. भाण्डेर अजा": [
      "सालौन बी",
      "भाण्डेर",
      "उन्नाव बालाजी",
      "ईमलिया उन्नाव ग्रामीण",
      "उडीना नया"
    ],
    "22. दतिया": [
      "दतिया नगर",
      "दतिया ग्रामीण",
      "बडौनी",
      "उदगुआ",
      "बसई",
      "सीतापुर नया"
    ]
  },
  "ग्वालियर नगर": {
    "15. ग्वालियर": [
      "कोटेश्वर महादेव",
      "संत रविदास",
      "वीर दुर्गादास राठौर",
      "रानी लक्ष्मीबाई",
      "राजा मानसिंह तोमर",
      "महाराजा अग्रसेन नया"
    ],
    "16. ग्वालियर पूर्व": [
      "पं. दीनदयाल उपाध्याय",
      "महाराणा प्रताप",
      "शहीद भगत सिंह",
      "स्वामी रामकृष्ण",
      "वीर सावरकर",
      "बाबासाहेब अंबेडकर नया"
    ],
    "17. ग्वालियर दक्षिण": [
      "अटल बिहारी  वाजपाई",
      "शहीद हेमू कालोनी",
      "डाॅ. श्यामा प्रसाद मुखर्जी",
      "स्वामी विवेकानंद",
      "गुप्तेश्वर महादेव"
    ]
  },
  "ग्वालियर ग्रामीण": {
    "14. ग्वालियर ग्रामीण": [
      "तानसेन बेहट",
      "उटिला",
      "बेरजा",
      "पुरानी छावनी",
      "कैंटोमेंट",
      "गिरवाई नया"
    ],
    "18. भितरवार": [
      "भितरवार",
      "आंतरी",
      "चीनोर",
      "घाटीगांव",
      "मोहना",
      "लखेश्वरी नया"
    ],
    "19. डबरा अजा": [
      "डबरा नं.",
      "डबरा गा्रं.",
      "पिछोर",
      "बिलौआ",
      "छीमक"
    ]
  },
  "श्योपुर": {
    "1. श्योपुर": [
      "श्योपुर",
      "बडोदा",
      "मानपुर",
      "प्रेमसर",
      "पाण्डोला नया",
      "श्योपुर ग्रामीण नया",
      "दांतरदा नया"
    ],
    "2.विजयपुर": [
      "विजयपुर",
      "वीरपुर",
      "कराहल",
      "गोरस",
      "गसवानी",
      "अगरा नया",
      "रघुनाथपुर नया"
    ]
  },
  "शिवपुरी": {
    "23. करेरा अजा": [
      "करेरा",
      "सिरसौद",
      "करही",
      "दिनारा",
      "नरवर"
    ],
    "24. पोहरी": [
      "पोहरी",
      "बैराड़",
      "सतनवाड़ा (नरवर ग्रामीण)",
      "सुभाषपुरा मुडैरी",
      "झिरी-भटनावर नया",
      "मुढैरी-कुंवरपुर नया"
    ],
    "25. शिवपुरी": [
      "शिवपुरी नगर",
      "शिवपुरी ग्रामीण",
      "शिवपुरी पुरानी",
      "खोड़",
      "वीरा-सरवाया नया",
      "शिवपुरी-फिजिकल नया"
    ],
    "26. पिछोर": [
      "पिछोर",
      "खनियाधाना",
      "बामोरकला",
      "मायापुर",
      "भौती",
      "मुहारी नया"
    ],
    "27. कोलारस": [
      "कोलारस",
      "बदरवास",
      "रन्नौद",
      "लुकवासा",
      "खराई",
      "खतौरा नया"
    ]
  },
  "गुना": {
    "28. बामोरी": [
      "म्याना",
      "बामोरी",
      "सिरसी",
      "झागर नया",
      "उमरी नया"
    ],
    "29. गुना अजा": [
      "गुना",
      "गुना कैंट",
      "बजरंगढ",
      "पगारा",
      "बूढे बालाजी नया"
    ],
    "30. चाचैड़ा": [
      "चाचैडा",
      "कुम्भराज",
      "मकसूदनगढ़",
      "रूठियाई",
      "मृगवास",
      "तेलीगांव नया"
    ],
    "31. राघोगढ़": [
      "राघोगढ़",
      "आरोन",
      "जामनेर",
      "पनवाडी",
      "फतेहगढ़"
    ]
  },
  "अशोक नगर": {
    "32. अशोकनगर अजा": [
      "अशोकनगर नगर",
      "अशोकनगर गा्रमीण",
      "शाढौरा",
      "राजपुर",
      "सोनेरा (कचनार)",
      "पछार नया"
    ],
    "33. चंदेरी": [
      "चंदेरी नगर",
      "चंदेरी गा्रमीण",
      "ईसागढ़",
      "नईसराय",
      "ढाकोनी (आनंदपुर)"
    ],
    "34. मुंगावली": [
      "मुंगावली",
      "बहादुरपुर",
      "पिपरई",
      "सहराई",
      "थूवोन",
      "अथाईखेडा नया"
    ]
  },
  "सागर": {
    "35. बीना अजा": [
      "बीना नगर",
      "बीना गा्रमीण",
      "भानगढ़ नया",
      "खिमलासा",
      "मण्डी बामोरा"
    ],
    "36. खुरई": [
      "खुरई नगर",
      "खुरई गा्रमीण",
      "मालथौन",
      "वांदरी",
      "धनौरा नया",
      "बरोदिया कलां नया"
    ],
    "37. सुरखी": [
      "सुरखी नगर",
      "सिहोरा",
      "राहतगढ़",
      "जयसिंह नगर",
      "बिलहरा",
      "राहतगढ़ नगर नया"
    ],
    "40. नरियावली अजा": [
      "नरयावली",
      "सागर गा्रमीण",
      "सदर",
      "मकरोनिया नगर",
      "मकरोनिया ग्रामीण"
    ],
    "41. सागर": [
      "सागर नगर",
      "डाॅ. हरिसिंह गौर",
      "डाॅ. भीमराव अम्बेकर",
      "यमुनाताई ठाकुर नया"
    ]
  },
  "सागर ग्रामीण": {
    "38. देवरी": [
      "देवरी नगर",
      "केसली",
      "गोरझामर",
      "महाराजपुर",
      "सहजपुर",
      "अनंतपुरा नया"
    ],
    "39. रेहली": [
      "रहेली नगर",
      "रहेली गा्रमीण",
      "गढ़ाकोटा नगर",
      "गढ़ाकोटा गा्रमीण",
      "शाहपुर",
      "पटना बुजुर्ग नया",
      "बलेह नया"
    ],
    "42. बण्डा": [
      "बण्डा नगर",
      "शाहगढ़",
      "बरोहल",
      "दलपतपुर",
      "बरा",
      "बरायठा नया",
      "छापरी नया"
    ]
  },
  "टीकमगढ़": {
    "43. टीकमगढ़": [
      "टीकमगढ़ नगर",
      "टीकमगढ़ गा्रमीण",
      "बडागांवधसान",
      "कुण्डेश्वर",
      "बुडेरा",
      "सावरकर नया"
    ],
    "44. जतारा अजा": [
      "जतारा",
      "लिधोरा",
      "थर बराना",
      "चंदेरा",
      "बम्हौरी कलां नया"
    ],
    "47. खरगापुर": [
      "पलेरा",
      "बल्देवगढ़",
      "खरगापुर",
      "कुडीला",
      "देरी नया"
    ]
  },
  "निवाड़ी": {
    "45. पृथ्वीपुर": [
      "पृथ्वीपुर नगर",
      "पृथ्वीपुर ग्रामीण नया",
      "मोहनगढ़",
      "जैरोन",
      "दिगोड़ा"
    ],
    "46. निवाडी": [
      "निवाडी नगर",
      "निवाड़ी ग्रामीण नया",
      "ओरछा",
      "तरीचकला",
      "नैगुआ नया"
    ]
  },
  "छतरपुर": {
    "48. महाराजपुर": [
      "महाराजपुर",
      "नौगांव नगर",
      "हरपालपुर",
      "लुगासी",
      "गढ़ीमलहरा नया"
    ],
    "49. चन्दला": [
      "चन्दला",
      "बारीगढ़",
      "सरवई",
      "बाछौन",
      "गौरीहार नया"
    ],
    "50. राजनगर": [
      "राजनगर",
      "बमीठा",
      "लवकुश नगर",
      "खजुराहो",
      "विक्रमपुर  नया"
    ],
    "51. छतरपुर": [
      "छतरपुर नगर",
      "छतरपुर ग्रामीण",
      "महेवा",
      "पड़रिया",
      "निवारी नया"
    ],
    "52. बिजावर": [
      "बिजावर",
      "सटई",
      "ईसानगर",
      "किशनगढ़",
      "मातगुवां नया"
    ],
    "53. बड़ा मलेहरा": [
      "बड़ामलेहरा नगर",
      "बड़ामलेहरा ग्रामीण",
      "घुवारा",
      "बक्सवाहा",
      "बाजना नया"
    ]
  },
  "पन्ना": {
    "58. पवई": [
      "पवई",
      "शाहनगर",
      "रैपुरा",
      "मोहन्द्रा, मोहर्रा सिमरिया",
      "कल्दा (आदिवासी)",
      "बिसानी नया",
      "सिमरिया नया"
    ],
    "59. गुन्नौर अजा": [
      "अमानगंज",
      "गुन्नौर",
      "देवेन्द्र नगर",
      "सलेहा",
      "ककरहटी",
      "महेबा नया"
    ],
    "60. पन्ना": [
      "पन्ना नगर",
      "पन्ना ग्रा.",
      "अजयगढ़",
      "धरमपुर",
      "बृजपुर",
      "बीरा नया"
    ]
  },
  "सतना": {
    "61. चित्रकुट": [
      "बिरसिंहपुर",
      "मझगवां",
      "बरौधा",
      "जैतवारा",
      "चित्रकुट नया"
    ],
    "62. रैगांव अजा": [
      "सोहावल",
      "सिंहपुर",
      "कोठी",
      "सेमरवारा",
      "भरजूना  नया"
    ],
    "63. सतना": [
      "सतना नगर पश्चिमी (कुशाभाऊ ठाकरे)",
      "सतना पूर्वी  (पं. दीनदयाल उपाध्याय)",
      "बाबूपुर",
      "अटल बिहारी वाजपेयी",
      "डाॅ. श्यामा प्रसाद मुखर्जी नया"
    ],
    "64. नागौद": [
      "नागौद",
      "उचेहरा",
      "परसमनिया",
      "अटरा",
      "जसो",
      "भरहुत  नया"
    ],
    "67. रामपुर बघेलान": [
      "रामपुर बघेलान",
      "मोहारी कटरा",
      "कोटर",
      "सज्जनपुर",
      "छिबौरा"
    ]
  },
  "मैहर  नया जिला": {
    "65. मैहर": [
      "मेैहर नगर",
      "नादन",
      "बदेरा",
      "अमदरा",
      "सोनवारी नया",
      "बेरमा नया"
    ],
    "66. अमरपाटन": [
      "अमरपाटन",
      "रामनगर",
      "ताला",
      "मर्यादापुर",
      "कठहा नया",
      "बड़वार नया"
    ]
  },
  "रीवा": {
    "68. सिरमौर": [
      "सिरमौर",
      "जवा",
      "डभौरा",
      "बैकुण्ठपुर नया",
      "अतरैला नया"
    ],
    "69. सेमरिया": [
      "सेमरिया",
      "शाहपुर",
      "बनकुंइया",
      "मनकहरी  नया"
    ],
    "70. त्याथौर": [
      "त्यौथर",
      "गढ़ी",
      "रायपुर सोनौरी",
      "कटरा नया"
    ],
    "73. मनगवां अजा": [
      "मनगवां",
      "रामपुर सकर्िल",
      "लालगांव (गढ)",
      "देवास नया",
      "सूरा नया"
    ],
    "74. रीवा": [
      "अटल (रीवा नगर)",
      "रीवा ग्रामीण",
      "बिछिया",
      "बोदाबाग (दीनदयाल)"
    ],
    "75. गुढ़": [
      "गुढ़",
      "गोविन्दगढ़",
      "रायपुरकुर्चलियान",
      "महसांव नया"
    ]
  },
  "मऊगंज  नया जिलाा": {
    "71. मउगंज": [
      "मउगंज",
      "हनुमना",
      "खटकरी",
      "शाहपुर नया",
      "पिपराही नया"
    ],
    "72. देवतालाब": [
      "देवतालाब",
      "रघुराज गढ़",
      "नईगढ़ी",
      "सीतापुर",
      "तमरी नया"
    ]
  },
  "सीधी": {
    "76. चुरहट": [
      "चुरहट",
      "रामपुरनैकिन",
      "खड्डी",
      "पटपरा",
      "चोरगड़ी",
      "पड़खुरी नया",
      "हनुमानगढ़ नया"
    ],
    "77. सीधी": [
      "सीधी नगर",
      "कुचवाही",
      "सेमरिया",
      "बरमबाबा",
      "अमरपुर",
      "चैफाल"
    ],
    "78. सिंहावल": [
      "सिंहावल",
      "बहरी",
      "सोनवष्र्ाा",
      "अमिलिया नया",
      "मायापुर नया"
    ],
    "82. धौहनी अजजा": [
      "मझौली",
      "मडवास",
      "कुसमी",
      "पौंडी निवास",
      "खडौरा नया"
    ]
  },
  "सिंगरौली": {
    "79. चितरंगी अजजा": [
      "चितरंगी",
      "गौरबी",
      "बगदरा",
      "कथ्र्ाुआ",
      "मौहरिया",
      "बगैया"
    ],
    "80. सिंगरौली": [
      "सिंगरौली",
      "बैढन",
      "तियरा",
      "विन्ध्यनगर",
      "जयन्त नगर"
    ],
    "81. देवसर अजा": [
      "खुटार",
      "माडा",
      "सरई",
      "बरगवां",
      "लंघाडोल",
      "रजमिलान"
    ],
    "82. धौहनी": [
      "निवास",
      "रजनिया  नया"
    ],
    "78. सिंहावल": [
      "देवसर जियावन",
      "नौडि़या"
    ]
  },
  "शहडोल": {
    "83. ब्यौहारी अजजा": [
      "बाणसागर",
      "ब्यौहारी",
      "पपौध",
      "सीधी",
      "आमडीह (करकी)",
      "टिकही नया",
      "मऊ नया"
    ],
    "84. जयसिंह नगर अजजा": [
      "जयसिंह नगर",
      "गोहपारू",
      "शहडोल नगर",
      "सोहागपुर",
      "सिंहपुर",
      "चुहरी  नया"
    ],
    "85. जैतपुर अजजा": [
      "बुढार",
      "खैहरा",
      "धनपुरी",
      "केशवाही",
      "जैतपुर",
      "बकहो नया"
    ]
  },
  "अनूपपुर": {
    "86. कोतमा": [
      "कोतमा नगर",
      "कोतमा गा्रमीण",
      "बिजुरी नगर",
      "राजनगर नगर",
      "राजनगर ग्रामीण"
    ],
    "87. अनूपपुर": [
      "अनूपपुर नगर",
      "अनूपपुर गा्रमीण",
      "फुनगा",
      "पसान",
      "जैतहरी"
    ],
    "88. पुष्पराजगढ़ अजजा": [
      "अमरकंटक",
      "राजेन्द्रगा्रम नगर",
      "बेनीवारी",
      "करपा",
      "वैंकट नगर",
      "दमेहडी  नया"
    ]
  },
  "उमरिया": {
    "89. बांधगढ़ अजजा": [
      "चंदिया",
      "उमरिया नगर",
      "उमरिया ग्रामीण",
      "करकेली",
      "नौरोजाबाद",
      "बिलासपुर नया",
      "कोहका  नया"
    ],
    "90. मानपुर अजजा": [
      "अमरपुर",
      "मानपुर",
      "पाली नगर",
      "पाली ग्रामीण",
      "पिपरिया",
      "बिजौरी नया",
      "इंदवार नया"
    ]
  },
  "जबलपुर नगर": {
    "97. जबलपुर पूर्व अजा": [
      "डाॅ. श्याम प्रसाद मुखर्जी",
      "लोकमान्य बाल गंगाधर तिलक",
      "शहीद अब्दुल हमीद",
      "नेता जी सुभाषचंद्र बोस"
    ],
    "98. जबलपुर उत्तर": [
      "शहीद चन्द्रशेखर आजाद",
      "स्वामी विवेकानंद",
      "पं. दीनदयाल उपाध्याय",
      "कुशाभाऊ ठाकरे",
      "आचार्य विद्यासागर  नया"
    ],
    "99. जबलपुर केन्ट": [
      "वीर सावरकर",
      "शहीद भगत सिंह",
      "छत्रपति शिवाजी",
      "अटल बिहारी वाजपेयी"
    ],
    "100. जबलपुर पश्चिम": [
      "गिरीराज किशोर कपूर",
      "रानी दुर्गावती",
      "मां नर्मदा",
      "महाराणा प्रताप",
      "महषर्ि वाल्िमकी  नया"
    ]
  },
  "जबलपुर ग्रामीण": {
    "95. पाटन": [
      "पाटन",
      "मझोली पश्चिम",
      "मझोली पूर्व",
      "कटंगी",
      "पोडा",
      "नुनसर"
    ],
    "96. बरगी": [
      "बरगी",
      "चरगवां",
      "शहपुरा",
      "भेडाघाट",
      "तिलवारा",
      "बेलखेड़ा"
    ],
    "101. पनागर": [
      "पनागर नगर",
      "पनागर पूर्व",
      "पनागर पश्चिम",
      "सोहागी करमेता",
      "बरेला",
      "महाराजपुर नया",
      "रानी दुर्गावती"
    ],
    "102. सीहोरा अजजा": [
      "सीहोरा नगर",
      "गोसलपुर (सीहोरा ग्रा.)",
      "मझगवां",
      "बघराजी",
      "कुण्डम",
      "चैरई कलां  नया"
    ]
  },
  "कटनी": {
    "91. बडवारा अजजा": [
      "बडवारा",
      "ढीमरखेडा",
      "सिलोडी",
      "देवरी हटाई",
      "कैमोर",
      "विलायतकला",
      "पान उमरिया"
    ],
    "92. विजयराघोगढ़": [
      "विजय राघवगढ़",
      "सिनगोडी",
      "बरही",
      "खितौली",
      "कांटी",
      "पिपरिया कलां नया"
    ],
    "93. मुडवारा": [
      "मुडवारा (कटनीनगर)",
      "माधवनगर",
      "न्यू कटनी",
      "कटनी गा्रमीण",
      "निवार",
      "स्लीमनाबाद",
      "पं. दीनदयाल उपाध्याय नया"
    ],
    "94. बहोरीबंद": [
      "बहोरीबंद",
      "रीठी",
      "बिलहरी",
      "बाकल",
      "कुआ",
      "देवगांव  नया"
    ]
  },
  "डिण्डौरी": {
    "103. शाहपुरा अजजा": [
      "मेहंदवानी",
      "अमरपुर",
      "शाहपुर",
      "शहपुरा",
      "मानिकपुर नया",
      "सक्का  नया"
    ],
    "104. डिण्डौरी अजजा": [
      "करंजिया",
      "बजाग",
      "समनापुर",
      "डिण्डौरी",
      "गोपालपुर नया",
      "गाड़ासरई नया",
      "बम्हनी नया"
    ]
  },
  "मण्डला": {
    "105. बिछिया अजजा": [
      "बिछिया",
      "मवई",
      "घुघरी",
      "अंजनिया",
      "घुटास नया",
      "सलवाह नया"
    ],
    "106. निवास अजजा": [
      "निवास",
      "नारायणगंज",
      "बीजाहाडी",
      "बकोरी",
      "मोहगांव",
      "बबलिया नया"
    ],
    "107. मण्डला अजजा": [
      "मण्डला नगर",
      "मण्डला ग्रामीण",
      "नैनपुर नगर",
      "नैनपुर ग्रामीण",
      "चिरई डोंगरी",
      "बम्हनी बंजर नगर",
      "पदमी चैराह नया"
    ]
  },
  "बालाघाट": {
    "108. बैहर अजजा": [
      "बिरसा",
      "मलाजखण्ड",
      "बैहर",
      "उकवा",
      "गढ़ी",
      "मंडई नया"
    ],
    "109. लांजी": [
      "किरनापुर",
      "लांजी",
      "भाडरा",
      "भानेगांव",
      "कारंजा नया",
      "माटे नया",
      "बिसोनी नया"
    ],
    "110. परसवाडा": [
      "हट्टा",
      "बालाघाट ग्रामीण",
      "लामटा",
      "परसवाडा",
      "मझगांव नया",
      "समनापुर नया",
      "रजेगांव नया"
    ],
    "111. बालाघाट": [
      "बालाघाट नगर",
      "लालबर्रा",
      "खमरिया",
      "भरवेली",
      "बालाघाट उत्तर नया",
      "मोहगांव नया"
    ],
    "112. वारासिवनी": [
      "वारासिवनी नगर",
      "वारासिवनी ग्रामीण",
      "खैरलाजी",
      "आरंभा नया",
      "रामपायली नया"
    ],
    "113. कटंगी": [
      "कटंगी",
      "कटोरी",
      "तिरोडी",
      "कटंगी पश्चिम नया",
      "मिरगपुर नया",
      "महकेपार नया"
    ]
  },
  "सिवनी": {
    "114. बरघाट अजजा": [
      "कुरई",
      "सुखतरा",
      "बरघाट",
      "धारना",
      "गंगेरूआ"
    ],
    "115. सिवनी": [
      "बारापत्थर (सिवनी उत्तर )",
      "मंगलीपेठ (सिवनी दक्षिण)",
      "करकोटी (सिवनी ग्रामीण)",
      "लखनवाडा नया",
      "मुगवानी",
      "बण्डोल",
      "चमारी",
      "बीजादेवरी"
    ],
    "116. केवलारी": [
      "केवलारी",
      "छपारा",
      "उगली",
      "धनोरा",
      "कान्हीवाडा",
      "पलारी",
      "छींद खैरलांजी नया"
    ],
    "117.लखनादौनअजजा": [
      "लखनादौन नगर",
      "आंदेगांव",
      "घूमा",
      "कहानी",
      "घंसोर",
      "केदारपुर",
      "नागनदेवरी नया"
    ]
  },
  "नरसिंहपुर": {
    "118. गोटेंगांव अजा": [
      "गोटेगांव नगर",
      "गोटेगांव ग्रामीण",
      "करकबेल",
      "मुंगवानी",
      "श्रीनगर नया",
      "ढांगीढाना नया"
    ],
    "119. नरसिंहपुर": [
      "नरसिंहपुर नगर",
      "नरसिंहपुर ग्रामीण",
      "करेली नगर",
      "करेली ग्रामीण",
      "नर्मदा",
      "सिंहपुर नया"
    ],
    "120. तेन्दूखेडा": [
      "चैगान",
      "सिहोरा",
      "चावरपाठा (तेंदूखेड़ा)",
      "कौडि़या नया",
      "तेंदूखेड़ा नया"
    ],
    "121. गाडरवाडा": [
      "गाडरवारा नगर",
      "साईखेडा",
      "चीचली",
      "सालीचैका",
      "आमगांव छोटा नया"
    ]
  },
  "छिंदवाड़ा": {
    "122. जुन्नारदेव अजजा": [
      "जुन्नारदेव नगर",
      "जुन्नारदेव ग्रामीण",
      "दमुआ नगर",
      "दमुआ ग्रामीण",
      "तामिया",
      "चावलपानी नया"
    ],
    "123. अमरवाडा अजजा": [
      "अमरवाडा नगर",
      "अमरवाडा ग्रामीण",
      "सिंगोडी",
      "बटकाखापा",
      "हरई",
      "छिन्दी",
      "सुरलाखापा"
    ],
    "124. चैरई": [
      "चैरई नगर",
      "चैरई ग्रामीण",
      "चांद",
      "बिछुआ",
      "कुण्डा",
      "खमारपानी नया"
    ],
    "126. छिन्दवाडा": [
      "छिन्दवाडा नगर (एक)",
      "छिन्दवाडा नगर (दो)",
      "छिन्दवाडा ग्रामीण",
      "सारना",
      "धरमटेकड़ी नया",
      "गुलाबरा नया"
    ],
    "127. परासिया अजा": [
      "परासिया नगर",
      "पगारा (परासिया ग्रा.)",
      "उमरेठ",
      "शिवपुरी",
      "पटपड़ा नया"
    ]
  },
  "पांढुण्र्ाा नया जिला": {
    "125. सौसर": [
      "सौसर",
      "लोधीखेडा ग्रा.",
      "पिपल्यानारायणवार",
      "मोहखेडा",
      "रामाकोना नया",
      "लिंगा नया"
    ],
    "128. पांढुण्र्ाा अजजा": [
      "पांढुण्र्ाा नगर",
      "पांढुण्र्ाा ग्रा.",
      "नंदनवाडी",
      "सावरी",
      "कुशाभाऊ ठाकरे नया",
      "श्यामाप्रसाद मुखर्जी (देवगढ़) नया"
    ]
  },
  "नर्मदापुरम्": {
    "136. सिवनी मालवा": [
      "सिवनीमालवा नगर",
      "सिवनीमालवा ग्रामीण",
      "केसला",
      "शिवपुर",
      "भीलटदेव",
      "डोलरिया"
    ],
    "137. नर्मदापुरम्": [
      "नर्मदापुरम् नगर",
      "नर्मदापुर नगर",
      "इटारसी नगर",
      "पुरानी इटारसी",
      "नर्मदापुरम् ग्रामीण"
    ],
    "138. सोहागपुर": [
      "सोहागपुर",
      "सेमरी",
      "माखन नगर (बावई)",
      "आरी बाबई पश्चिम",
      "रामपुर",
      "शोभापुर"
    ],
    "139. पिपरिया अजा": [
      "पिपरिया नगर",
      "पिपरिया ग्रामीण",
      "बनखेडी नगर",
      "पंचमढ़ी",
      "चांदौन ग्रामीण",
      "खापरखेड़ा",
      "बनखेडी ग्रामीण नया"
    ]
  },
  "हरदा": {
    "134. टिमरनी अजजा": [
      "टिमरनी",
      "कायदा नया",
      "रेहटगांव",
      "सिराली",
      "करताना नया",
      "पहटकलां  नया"
    ],
    "135. हरदा": [
      "हरदा नगर",
      "हरदा ग्रा.",
      "खिरकिया",
      "हाण्िडया",
      "सोनतलाई नया",
      "चारूवा नया"
    ]
  },
  "बैतूल": {
    "129. मुलताईृ": [
      "मुलताई नगर",
      "मुलताई ग्रामीण",
      "प्रभात पटट्नम",
      "दुनावा",
      "मासौदा"
    ],
    "130. आमला अजा": [
      "आमला नगर",
      "आमला ग्रामीण",
      "सारणी नगर",
      "सारणी ग्रामीण",
      "मोरखा"
    ],
    "131. बैतूल": [
      "बैतूल गंज",
      "बतूल ग्रामीण",
      "बैतूल बाजार",
      "आठनेर नगर",
      "बडोरा",
      "कोठी बाजार"
    ],
    "132. घोडाडोंगरी अजजा": [
      "घोडाडोंगरी",
      "चिचोली नगर",
      "चिचैली ग्रामीण",
      "शाहपुर",
      "भौरा",
      "चोपना",
      "पाढर"
    ],
    "133. भैंसदेही अजजा": [
      "भैंसदेही नगर",
      "भैंसदेही ग्रामीण",
      "आठनेर ग्रामीण",
      "भीमपुर",
      "दामजीपुरा",
      "रतनपुर नया",
      "सावलमेढ़ा नया"
    ]
  },
  "भोपाल नगर": {
    "150. भोपाल उत्तर": [
      "रानी कमलपती (शाहजहानाबाद)",
      "गुरूनानक(शाहजहानाबाद)",
      "वीर सावरकर (बस स्टैण्ड)",
      "राजाभोज (अग्रसेन)",
      "नवल शाह नया मण्डल"
    ],
    "151. नरेला": [
      "स्टेशन",
      "सुभाष",
      "स्वामी विवेकानंद (करोंद)",
      "शहीद भगत सिंह (करोंद)",
      "अशोका गार्डन",
      "महामाई"
    ],
    "152. दक्षिण पश्चिम": [
      "टैगोर  (टी.टी. नगर)",
      "तात्याटोपे",
      "करूणाधाम ( नेहरू नगर )",
      "पंचशील नगर",
      "माता शबरी नया"
    ],
    "153. भोपाल मध्य": [
      "बरखेडी",
      "चैक",
      "अरेरा",
      "महाराणाप्रताप",
      "शाहपुरा"
    ],
    "154. गोविंदपुरा": [
      "अवधपुरी",
      "मिसरोद",
      "साकेतनगर",
      "आनंदनगर",
      "इन्द्रपुरी",
      "भानपुर"
    ],
    "155. हुजुर": [
      "बैरागढ़ संतहिरदाराम नगर",
      "गांधीनगर",
      "डाॅ. श्यामा प्रसाद मुखर्जी नगर (कोलार)",
      "अटल बिहारी वाजपेयी (कोलार)"
    ]
  },
  "भोपाल ग्रामीण": {
    "149. बैरसिया अजा": [
      "नजीराबाद",
      "हर्राखेडा",
      "बैरसिया नगर",
      "बैरसिया ग्रामीण",
      "हरिसिद्धि",
      "परवलिया सड़क"
    ],
    "155. हुजुर": [
      "बिलखिरिया",
      "फन्दा",
      "पं. दीनदयाल",
      "नीलबड़ (रातीबड़)"
    ]
  },
  "रायसेन": {
    "140. उदयपुरा": [
      "उदयपुरा",
      "बरेली नगर",
      "भारकच्छ",
      "देवरी",
      "बरेली ग्रामीण",
      "खरगोन नया मण्डल",
      "नूरनगर नया मण्डल"
    ],
    "141. भोजपुर": [
      "मंडीदीप नगर",
      "औबेदुल्लागंज",
      "बाडी",
      "सुल्तानपुर",
      "मण्डीदीप ग्रामीण",
      "भोजपुर"
    ],
    "142. सांची अजा": [
      "रायसेन",
      "सांची",
      "गैरतगंज",
      "खरबई",
      "साॅचेत",
      "देवनगर (देवगांव)",
      "गैरतगंज ग्रामीण नया",
      "सलामतपुर नया"
    ],
    "143. सिलवानी": [
      "सिलवानी पूर्व",
      "सिलवानी पश्चिम",
      "बेगमगंज नं.",
      "बेगमगंज ग्रा.",
      "सुल्तानगंज ग्रामीण",
      "प्रतापगढ़ नया"
    ]
  },
  "विदिशा": {
    "144. विदिशा": [
      "गुलाबगंज",
      "वैत्रवति (विदिशा नगर)",
      "दुर्गानगर (विदिशा नगर)",
      "बैसनगर (विदिशा ग्रामीण)",
      "अहमदपुर",
      "ढोलखेड़ी नया"
    ],
    "145. बासौदा": [
      "गंजबासोदा नगर",
      "गंजबासोदा ग्रामीण",
      "ग्यारसपुर",
      "त्योंदा",
      "सिरनोटा नया"
    ],
    "146. कुरवाई अजा": [
      "कुरवाई",
      "पथरिया",
      "मेहलुआ चैराहा",
      "पठारी",
      "उदयपुर",
      "दीपनाखेड़ा नया",
      "अम्बानगर नया"
    ],
    "147. सिरोज": [
      "सिरोज नगर",
      "लटेरी",
      "आनंदपुर",
      "चितावर",
      "देवपुर"
    ],
    "148. शमशाबाद": [
      "नटेरन",
      "शमशाबाद",
      "खामखेडा",
      "सतपाडा हाट",
      "देव खाजूरी नया"
    ]
  },
  "सीहोर": {
    "156. बुदनी": [
      "नसरूल्लागंज",
      "सलकनपुर",
      "शाहगंज",
      "बुधनी",
      "गोपालपुर",
      "लाड़कुई",
      "चकल्दी"
    ],
    "157. आष्टा अजा": [
      "आष्टा नगर",
      "आष्टा ग्रा.",
      "जावर",
      "कोठरी",
      "सिद्विकगंज",
      "मैना नया",
      "खाचरोद नया",
      "डोडी नया"
    ],
    "158. इच्छावर": [
      "इच्छावर",
      "बिलकिसगंज",
      "बरखेडी",
      "गुड़भेला",
      "दीवडि़या"
    ],
    "159. सीहोर": [
      "सीहोर नगर-1",
      "श्यामपुर",
      "दोराहा",
      "अहमदपुर",
      "सीहोर नगर - 2 नया"
    ]
  },
  "राजगढ़": {
    "160. नरसिंहगढ़": [
      "नरसिंहगढ़",
      "कुरावर",
      "तलेन",
      "बोड़ा",
      "झाड़ला नया",
      "मण्डावर नया"
    ],
    "161. ब्यावरा": [
      "ब्यावरा",
      "गादिया",
      "सुठालिया",
      "पिपलहेला",
      "मलावर नया",
      "गिन्दौरहाट नया"
    ],
    "162. राजगढ़": [
      "राजगढ़",
      "खुजनेर",
      "कालीपीठ",
      "पपडेल",
      "करेड़ी नया",
      "पिपलोदी नया"
    ],
    "163. खिलचीपुर": [
      "खिलचीपुर",
      "जीरापुर",
      "माचलपुर",
      "छापीहेड़ा",
      "रामगढ़ नया",
      "भण्डावद नया"
    ],
    "164. सांरगपुर अजा": [
      "सांरगपुर नगर",
      "संडावता",
      "पचैर",
      "गुलावता",
      "पड़ाना नया"
    ]
  },
  "इंदौर नगर": {
    "204. इंदौर-1": [
      "सुभाषचन्द्र बोस",
      "लक्ष्मीबाई",
      "सम्राट अशोक",
      "चन्द्रशेखर आजाद",
      "लवकुश",
      "गुरू टेकचंद  नया"
    ],
    "205. इंदौर-2": [
      "डाॅ. अम्बेडकर",
      "रामायण",
      "पं. दीनदयाल उपाध्याय",
      "डाॅ. श्यामा प्रसाद मुखर्जी",
      "संतश्री मोनी बाबा",
      "संतश्री बालीनाथ",
      "राजमाता जीजाबाई नया",
      "संतश्री रविदास  नया"
    ],
    "206. इंदौर-3": [
      "कुशाभाउ ठाकरे",
      "देवी अहिल्या बाई",
      "अटल बिहारी वाजपेयी",
      "राजेन्द्र धारकर नया"
    ],
    "207. इंदौर-4": [
      "हेमू कालोनी",
      "महाराणाप्रताप",
      "लक्ष्मण सिंह गौड",
      "शहीद भगत सिंह"
    ],
    "208. इंदौर-5": [
      "शिवाजी",
      "सरदार बल्लभ पटेल तिलक",
      "छत्रसाल",
      "वीर सावरकर",
      "ऐ. पी. जे. अब्दुल कलाम",
      "संत कबीरदास नया",
      "ज्योतिबा फुले नया"
    ],
    "210. राऊ": [
      "निर्भय सिंह पटेल",
      "समा्रट चंद्रगुप्त मौर्य",
      "गुरू गोविंद सिंह"
    ],
    "203. देपालपुर": [
      "सरदार पटेल"
    ],
    "211. सांवेर": [
      "निपानिया"
    ]
  },
  "इंदौर ग्रामीण": {
    "209. महू": [
      "भीमराव अंबेडकर -कोदरिया",
      "केजी माहेष्वरी- मंहू नगर",
      "शहीद टंट्यामामा- सिमरोल",
      "भेरूलाल पाटीदार- मंहूगांव",
      "भगवान परषुराम- मानपुर"
    ],
    "203. देपालपुर": [
      "चैबीस अवतार- देपालपुर",
      "धन्नालाल पटैल- गौतमपुरा",
      "गुरूनानक देव- बेटमा",
      "महाराज यषवंत राव- हातोद"
    ],
    "211. सांवेर": [
      "प्रकाश सोनकर- सांवेर",
      "मां ष्िाप्रा- शिप्रा",
      "मां अहिल्या- पालिया",
      "मां नर्मदा -खुडेल"
    ],
    "210. राऊ": [
      "राऊ",
      "कैलाश पाटीदार",
      "राऊ ग्रामीण नया"
    ]
  },
  "खण्डवा": {
    "175. मांधाता": [
      "पुनासा",
      "किल्लोद",
      "मूंदी",
      "ओंकारेश्वर",
      "कावेरी नया"
    ],
    "176. हरसूद": [
      "हरसूद नगर",
      "हरसूद ग्रामीण",
      "रोशनी",
      "खालवा",
      "खार",
      "आशापुर नया"
    ],
    "177. खण्डवा अजजा": [
      "कुशाभाउ ठाकरे  (खण्डवा नगर)",
      "अटल बिहारी वाजपेयी",
      "जावर (खण्डवा ग्रा.)",
      "अमलपुरा",
      "पं. दीनदयाल उपाध्याय नया"
    ],
    "178. पंधाना अजजा": [
      "पंधाना",
      "छैगांव माखन",
      "बोरगांव",
      "चिचगोहन",
      "गुडीखेड़ा",
      "सिंगोठ"
    ]
  },
  "बुरहानपुर": {
    "179. नेपानगर अजजा": [
      "नेपानगर नगर.",
      "नावरा (नेपानगर ग्रा.)",
      "खकनार",
      "धुलकोट",
      "अटलबिहारी बाजपेयी(दर्यापुर)",
      "कुशाभाऊ ठाकरे"
    ],
    "180. बुरहानुपर": [
      "बहादरपुर (बुरहानपुर नगर)",
      "डाॅ.श्यामा प्रसाद मुखर्जी लालबाग (बुरहानपुर ग्रा.)",
      "लोकमान्य तिलक",
      "सरदार बल्लभ भाई पटेल",
      "शाहपुर",
      "पंडित दीनदयाल उपाध्याय",
      "लोकमाता अहिल्या देवी नया"
    ]
  },
  "खरगौन": {
    "181.  भीकनगांव अजजा": [
      "भीकनगांव",
      "झिरन्या",
      "चिरिया",
      "आभापुरी (शिवना) नया",
      "भीकनगांव (पश्चिम) नया"
    ],
    "182. बड़वाह": [
      "बड़वाह नगर",
      "बड़वाह ग्रा.",
      "सनावद नगर",
      "सनावद ग्रा.",
      "बैडि़या"
    ],
    "183. महेश्वर अजा": [
      "महेश्वर",
      "करही",
      "बलवाड़ा",
      "मंडलेश्वर"
    ],
    "184. कसरावद": [
      "कसरावद पूर्व",
      "कसरावद पश्चिम",
      "अंदड़",
      "कसरावद दक्षिण नया",
      "कसरावद नगर नया"
    ],
    "185. खरगौन": [
      "खरगौन नगर (पूर्व)",
      "खरगौन ग्रा.",
      "गोगावा",
      "खरगौन नगर (पश्चिम) नया"
    ],
    "186. भगवानपुरा अजजा": [
      "भगवानपुरा",
      "बिस्टान",
      "सैगांव",
      "बरूड़",
      "सिरवेल महादेव नया"
    ]
  },
  "बड़वानी": {
    "187. सेंधवा अजजा": [
      "सेंधवा नगर",
      "संेधवा ग्रामीण",
      "धनोरा",
      "बलवाड़ी",
      "चाचरिया",
      "धवली",
      "शाहपुरा नया"
    ],
    "188. राजपुर अजजा": [
      "राजपुर",
      "जुलवानीया",
      "ठीकरी",
      "अंजड़",
      "तलवाडा",
      "ओझर"
    ],
    "189. पानसेमल अजजा": [
      "पानसेमल नगर",
      "चाटली",
      "खेतिया",
      "पलसूद",
      "निवाली",
      "जलगोन नया"
    ],
    "190. बड़वानी अजजा": [
      "बड़वानी नगर",
      "बड़वानी ग्रामीण",
      "पाटी",
      "सिलावद",
      "गंधावल बोकराटा",
      "भवती बिजासन",
      "मेणीमाता"
    ]
  },
  "अलीराजपुर": {
    "191. अलीराजपुर अजजा": [
      "अलीराजपुर नगर",
      "अलीराजपुर ग्रामीण",
      "सौरवा",
      "छकतला",
      "सोण्डवा",
      "उमराली नया"
    ],
    "192. जोबट अजजा": [
      "चन्द्रशेखर आजाद नगर",
      "उदयगढ़",
      "कटटीवाड़ा",
      "जोबट",
      "खटटाली",
      "आम्बुआ",
      "बरझर"
    ]
  },
  "झाबुआ": {
    "193. झाबुआ अजजा": [
      "झाबुआ नगर",
      "पिटोल (झाबुआ ग्रा.)",
      "देवझरी नया",
      "राणापुर",
      "वन (राणापुर ग्रा.)",
      "कल्याणपुरा",
      "बोरी"
    ],
    "194. थांदला अजजा": [
      "थांदला",
      "काकनवानी  (थांदला ग्रा.)",
      "मेघनगर",
      "मदरानी",
      "नौगांवा",
      "खवासा"
    ],
    "195. पेटलावद अजजा": [
      "पेटलावद",
      "सारंगी (पेटलावद ग्रा.)",
      "रायपुरिया",
      "पारा",
      "रामा",
      "कुंदनपुर",
      "झकनावद नया"
    ]
  },
  "धार": {
    "196. सरदारपुर अजजा": [
      "सरदारपुर",
      "राजगढ़ नगर",
      "राजगढ़ ग्रामीण",
      "अमझेरा दसाई",
      "लाबरिया (राजोद)"
    ],
    "201. धार": [
      "कुशाभाउ ठाकरे",
      "धार ग्रामीण",
      "तिरला",
      "दिग्ठान",
      "पीथमपुर",
      "सेनापति",
      "सागौर"
    ],
    "202. बदनावर": [
      "बदनावर नगर",
      "बदनावर ग्रा.",
      "कानवन",
      "सादलपुर",
      "बखतगढ़",
      "बिडवाल"
    ]
  },
  "धार ग्रामीण": {
    "197. गंधवानी": [
      "गंधवानी",
      "बाग",
      "कछावदा",
      "जीराबाद",
      "टाण्डा"
    ],
    "198. कुक्षी अजजा": [
      "कुक्षी नगर",
      "कुक्षी ग्रामीण",
      "निसरपुर",
      "डही",
      "बडदा"
    ],
    "199. मनावर अजजा": [
      "मनावर नगर",
      "मनावर ग्रा.",
      "उमरबन",
      "सिंघाना",
      "बाकानेर"
    ],
    "200. धरमपुरी अजजा": [
      "धरमपुरी",
      "धामनोद",
      "नालक्षा",
      "गुजरी",
      "बगड़ी नया"
    ]
  },
  "उज्जैन नगर": {
    "216. उज्जैन उत्तर": [
      "दौलतगंज",
      "सराफा",
      "जीवाजीगंज",
      "कातर्िक चैक",
      "विक्रमादित्य",
      "डाॅ. श्यामा प्रसाद मुखजी  नया"
    ],
    "217. उज्जैन दक्षिण": [
      "माधवनगर",
      "केशवनगर",
      "महाराजवाडा",
      "पं. दीनदयाल",
      "शहीद राजभाऊ महाकाल  नया"
    ]
  },
  "उज्जैन ग्रा.": {
    "212. नागदा": [
      "नागदा नगर",
      "नागदा ग्रामीण",
      "खाचरौद नगर",
      "खाचरौद ग्रामीण",
      "खाचरौद ग्रामीण (दक्षिण) नया",
      "नागदा बिरलाग्राम नया"
    ],
    "213. महिदपुर": [
      "महिदपुर नगर",
      "महिदपुर ग्रामीण",
      "झारडा",
      "महिदपुर रोड़"
    ],
    "214. तराना अजा": [
      "तराना नगर",
      "तराना ग्रामीण",
      "माकडोन",
      "कनासिया"
    ],
    "215. घटिया अजा": [
      "घटिया",
      "ताजपुर",
      "पानबिहार",
      "उन्हेल"
    ],
    "218. बडनगर": [
      "बडनगर नगर",
      "बडनगर ग्रामीण",
      "इन्गोरिया",
      "खरसोदकलां",
      "खरसौद खुर्द नया"
    ],
    "217. उज्जैन दक्षिण": [
      "उज्जैन ग्रामीण (दक्षिण)"
    ]
  },
  "शाजापुर": {
    "167. शाजापुर": [
      "शाजापुर नगर",
      "शाजापुर ग्रामीण",
      "पनवाडी",
      "मोहन बडोदिया",
      "बेरछा",
      "मक्सी"
    ],
    "168. शुजालपुर": [
      "शुजालपुर नगर",
      "शुजालपुर ग्रामीण",
      "अकोदिया",
      "गुलाना",
      "सुन्दरसी"
    ],
    "169. कालापीपल": [
      "कालापीपल",
      "खोकराकलां",
      "अरनियाकलां",
      "पोलायकलां",
      "अवंतीपुर बड़ोदिया  नया",
      "लसुल्िडया  नया"
    ]
  },
  "आगर": {
    "165. सुसनेर": [
      "सुसनेर",
      "नलखेड़ा",
      "बड़ागांव",
      "सोयत",
      "मोड़ी नया",
      "मोहना नया",
      "धरोला नया"
    ],
    "166. आगर अजा": [
      "आगर नगर",
      "कानड़",
      "बड़ौद",
      "बीजानगरी",
      "आगर ग्रामीण",
      "तनोडि़या नया",
      "मदकोटा नया"
    ]
  },
  "देवास": {
    "170. सोनकच्छ अजा": [
      "टोकखुर्द नगर",
      "टोकखुर्द ग्रामीण",
      "सोनकच्छ नगर",
      "सोनकच्छ (काशी)",
      "भौरासा नया"
    ],
    "171. देवास": [
      "देवास सीनियर",
      "देवास जूनियर",
      "देवास ग्रामीण",
      "श्रीमंत महाराजा",
      "सतगुरू शीलनाथ नया"
    ],
    "172. हाटपिपल्या": [
      "हाटपिपल्या नगर",
      "हाटपीपल्या ग्रामीण",
      "बरोठा",
      "क्षिप्रा",
      "राजोदा नया"
    ],
    "173. खातेगांव": [
      "खातेगांव",
      "कन्नौद",
      "हरनगांव",
      "नेमावर मंदसौर",
      "पानीगांव नया"
    ],
    "174. बागली अजजा": [
      "बागली",
      "सतवास",
      "उदयनगर",
      "काॅटाफोड लोहारदा",
      "कण्र्ोश्वर नया"
    ]
  },
  "रतलाम": {
    "219. रतलाम ग्रा. अजा": [
      "नामली",
      "धराड",
      "शबरी",
      "शहीद चन्द्रशेखर आजाद",
      "बांगरोद"
    ],
    "220. रतलाम सिटी": [
      "डाॅ. श्यामा प्रसाद मुखर्जी",
      "पं. दीनदयाल दीनदयाल",
      "सूरजमल जैन",
      "डाॅ. अम्बेडकर",
      "कुशाभाउ ठाकरे"
    ],
    "221. सैलाना अजजा": [
      "बाजना",
      "रावटी शिवगढ़",
      "सैलाना",
      "बेडदा",
      "राजपुरा"
    ],
    "222. जावरा": [
      "जावरा ग्रामीण",
      "पिपलोदा",
      "जावरा नगर",
      "सूखेडा",
      "डाॅ. लक्ष्मीनारायण पांडे नया"
    ],
    "223. आलोट अजा": [
      "आलोट",
      "ताल",
      "बडावदा",
      "श्रीमंत राजमाता विजयाराजे सिंधिया",
      "जोगणिया माता"
    ]
  },
  "मंदसौर": {
    "224. मंदसौर": [
      "मंदसौर ग्रामीण",
      "मंदसौर दक्षिण",
      "दलौदा",
      "मंदसौर उत्तर",
      "मगरा माताजी  नया"
    ],
    "225. मल्हारगढ़ अजा": [
      "मल्हारगढ़",
      "बूढा बुरहानपुर",
      "घुन्धडका",
      "पिपल्यामण्डी",
      "गुर्जर बडिऱ्या नया"
    ],
    "226. सुवासरा": [
      "सुवासरा",
      "सीतामउ नगर",
      "सीतामउ ग्रामीण",
      "कयामपुर",
      "शामगढ़",
      "बसई नया"
    ],
    "227. गरोठ": [
      "गरोठ",
      "भानपुरा",
      "मेलखेडा",
      "भैसोदा",
      "खडावदा"
    ]
  },
  "नीमच": {
    "228. मनासा": [
      "श्यामाप्रसाद मुखर्जी (मनासा नगर)",
      "पं. दीनदयाल  (मनासा ग्रामीण)",
      "कुकडेश्वर",
      "रामपुरा",
      "कुशाभाऊ ठाकरे (मनासा) नया"
    ],
    "229. नीमच": [
      "पं. दीनदयाल (नीमच सिटी)",
      "भादवामाता",
      "नीमच उत्तर",
      "नीमच दक्षिण",
      "श्यामाप्रसाद मुखर्जी (बघाना)",
      "कुशाभाऊ ठाकरे (नीमच) नया"
    ],
    "230. जावद": [
      "जावद",
      "मोरवन",
      "रतनगढ",
      "सिगोली"
    ]
  }
};
    // ===============================
// LOCATION HELPERS (district -> vidhansabha -> mandal)
// ===============================
function initDistrictCascade() {
  const dEl = $("district");
  const vEl = $("vidhansabha");
  const mEl = $("mandal");
  if (!dEl || !vEl || !mEl) return;

  // Populate Districts
  dEl.innerHTML = '<option value="">— जिला चुनें —</option>';
  Object.keys(DISTRICT_DATA).sort((a,b)=>a.localeCompare(b,"hi")).forEach((d) => {
    const opt = document.createElement("option");
    opt.value = d;
    opt.textContent = d;
    dEl.appendChild(opt);
  });

  dEl.addEventListener("change", () => {
    const dVal = dEl.value;
    vEl.innerHTML = '<option value="">— विधानसभा चुनें —</option>';
    mEl.innerHTML = '<option value="">— पहले विधानसभा चुनें —</option>';
    vEl.disabled = !dVal;
    mEl.disabled = true;

    if (dVal && DISTRICT_DATA[dVal]) {
      Object.keys(DISTRICT_DATA[dVal]).sort((a,b)=>a.localeCompare(b,"hi")).forEach((v) => {
        const opt = document.createElement("option");
        opt.value = v;
        opt.textContent = v;
        vEl.appendChild(opt);
      });
    }
  });

  vEl.addEventListener("change", () => {
    const dVal = dEl.value;
    const vVal = vEl.value;
    mEl.innerHTML = '<option value="">— मंडल चुनें —</option>';
    mEl.disabled = !vVal;

    if (dVal && vVal && DISTRICT_DATA[dVal] && DISTRICT_DATA[dVal][vVal]) {
      DISTRICT_DATA[dVal][vVal].slice().sort((a,b)=>a.localeCompare(b,"hi")).forEach((m) => {
        const opt = document.createElement("option");
        opt.value = m;
        opt.textContent = m;
        mEl.appendChild(opt);
      });
    }
  });
}

function applyLocationAutofill(info) {
  // info: {district, vidhansabha, mandal}
  if (!info) return;
  const d = safeStr(info.district).trim();
  const v = safeStr(info.vidhansabha).trim();
  const m = safeStr(info.mandal).trim();

  if (d && $("district")) {
    $("district").value = d;
    $("district").dispatchEvent(new Event("change"));
    setTimeout(() => {
      if (v && $("vidhansabha")) {
        $("vidhansabha").value = v;
        $("vidhansabha").dispatchEvent(new Event("change"));
        setTimeout(() => {
          if (m && $("mandal")) $("mandal").value = m;
        }, 120);
      }
    }, 120);
  }
}
    // ===============================
// LEVEL (optional fixed)
// ===============================
const LEVELS = ["district","vidhansabha","mandal"];

function setLocationVisibility(level) {
  const dWrap = $("wrap-district");
  const vWrap = $("wrap-vidhansabha");
  const mWrap = $("wrap-mandal");
  if (!dWrap || !vWrap || !mWrap) return;

  // default show all
  dWrap.classList.remove("hidden");
  vWrap.classList.remove("hidden");
  mWrap.classList.remove("hidden");

  if (level === "district") {
    vWrap.classList.add("hidden");
    mWrap.classList.add("hidden");
  } else if (level === "vidhansabha") {
    mWrap.classList.add("hidden");
  }
}

function initLevelControl(cfg, formType) {
  const levelEl = $("level");
  if (!levelEl) return;

  // decide fixed: url param > config fixed > none
  const fixedFromCfg = getFixedLevel(cfg, formType);
  const fixed = (LEVELS.includes(levelParam) ? levelParam : "") || (LEVELS.includes(fixedFromCfg) ? fixedFromCfg : "");

  if (fixed) {
    levelEl.value = fixed;
    levelEl.disabled = true;
    if ($("level-note")) $("level-note").textContent = `Level locked: ${fixed}`;
  } else {
    levelEl.disabled = false;
    if ($("level-note")) $("level-note").textContent = "Level: आप बदल सकते हैं";
  }

  setLocationVisibility(levelEl.value);

  levelEl.addEventListener("change", () => {
    setLocationVisibility(levelEl.value);
  });
}
    // ===============================
// MULTI-PHOTO (optional)
// ===============================
let selectedFiles = [];

function refreshPhotoUI() {
  const grid = $("photo-grid");
  const hint = $("photo-hint");
  if (!grid) return;

  grid.innerHTML = "";
  if (!selectedFiles.length) {
    if (hint) hint.classList.remove("hidden");
    return;
  }
  if (hint) hint.classList.add("hidden");

  selectedFiles.forEach((f, idx) => {
    const url = URL.createObjectURL(f);
    const card = document.createElement("div");
    card.className = "relative overflow-hidden rounded-xl border border-white/10 bg-white/5";
    card.innerHTML = `
      <img src="${url}" class="w-full h-24 object-cover" alt="photo-${idx}">
      <button type="button" class="absolute top-2 right-2 bg-black/60 hover:bg-black/70 text-white rounded-full w-7 h-7 flex items-center justify-center border border-white/10" data-idx="${idx}">
        <i class="fa-solid fa-xmark text-xs"></i>
      </button>
    `;
    card.querySelector("button").addEventListener("click", () => {
      selectedFiles.splice(idx, 1);
      refreshPhotoUI();
    });
    grid.appendChild(card);
  });
}

function onPhotosSelected(ev, maxFiles=10) {
  const files = Array.from((ev.target.files || []));
  if (!files.length) return;

  const next = selectedFiles.concat(files);
  selectedFiles = next.slice(0, maxFiles);
  $("photos").value = "";
  refreshPhotoUI();
}

    let remoteCfg = null;

    async function initAll() {
      initDistrictCascade();

      remoteCfg = await loadRemoteConfig(FORM_TYPE);
      applyBrandingFromConfig(remoteCfg, FORM_TYPE, "कार्यक्रम रिपोर्टिंग", "Program Reporting", "", "default-icon");
      // === Admin Console iframe live preview fallback snapshot (2026-02-17)
      try {
        window.__EL_PREVIEW_FALLBACKS = {
          title: (document.getElementById("org-name")?.textContent || "").trim(),
          subtitle: (document.getElementById("org-subtitle")?.textContent || "").trim(),
          tagline: (document.getElementById("org-tagline")?.textContent || "").trim(),
          iconId: "default-icon"
        };
      } catch(e) {}



      if ($("org-tagline") && $("org-tagline").textContent.trim()) $("org-tagline").classList.remove("hidden");
      if ($("footer-text") && $("footer-text").textContent.trim() === "") $("footer-text").textContent = "Powered by EventLens";

      fillProgramNames(remoteCfg, "program_name");
      initLevelControl(remoteCfg, FORM_TYPE);

      // Multi-photo events
      $("add-photo-btn").addEventListener("click", () => $("photos").click());
      $("photos").addEventListener("change", (ev) => onPhotosSelected(ev, 10));
      refreshPhotoUI();
    }

    document.addEventListener("DOMContentLoaded", initAll);

    function validateLocation(level, data) {
      if (level === "district") {
        if (!data.district) throw new Error("कृपया जिला चुनें");
      } else if (level === "vidhansabha") {
        if (!data.district) throw new Error("कृपया जिला चुनें");
        if (!data.vidhansabha) throw new Error("कृपया विधानसभा चुनें");
      } else {
        if (!data.district) throw new Error("कृपया जिला चुनें");
        if (!data.vidhansabha) throw new Error("कृपया विधानसभा चुनें");
        if (!data.mandal) throw new Error("कृपया मंडल चुनें");
      }
    }

    async function submitWithFiles(data) {
      const files = selectedFiles.slice();
      const count = files.length;

      // 0 file -> file_kind none
      if (count === 0) {
        const res = isPublicMode()
          ? await apiCall("public_create_entry", { token, form_type: FORM_TYPE, file_kind: "none", payload: data })
          : await apiCall("create_entry", { collection_id: cidParam, form_type: FORM_TYPE, file_kind: "none", payload: data });

        const finalizeAction = isPublicMode() ? "public_finalize_entry" : "finalize_entry";
        await apiCall(finalizeAction, { finalize_token: res.finalize_token, entry_id: res.entry_id });
        return;
      }

      // 1 file -> single upload
      if (count === 1) {
        const file = files[0];
        const sha = await sha256Hex(file);
        const fileName = `${crypto.randomUUID()}.jpg`;

        const res = isPublicMode()
          ? await apiCall("public_create_entry", { token, form_type: FORM_TYPE, sha256: sha, file_name: fileName, mime_type: file.type || "image/jpeg", payload: data })
          : await apiCall("create_entry", { collection_id: cidParam, form_type: FORM_TYPE, sha256: sha, file_name: fileName, mime_type: file.type || "image/jpeg", payload: data });

        if (res.upload_url) await uploadToS3(res.upload_url, file);

        const finalizeAction = isPublicMode() ? "public_finalize_entry" : "finalize_entry";
        await apiCall(finalizeAction, { finalize_token: res.finalize_token, entry_id: res.entry_id });
        return;
      }

      // Multi upload (President form style): upload + finalize each photo as separate entry (backend unchanged)
      const btnEl = $("submitBtn");
      for (let idx = 0; idx < files.length; idx++) {
        const f = files[idx];
        if (btnEl) btnEl.innerHTML = `<i class=\"fa-solid fa-spinner fa-spin\"></i> Uploading ${idx + 1}/${files.length}...`;
        const sha = await sha256Hex(f);
        const fileExt = (f.type && f.type.includes("png")) ? "png" : "jpg";
        const fileName = `${crypto.randomUUID()}.${fileExt}`;

        // Optional: store photo index in payload (non-breaking)
        const payloadWithIdx = Object.assign({}, data, { photo_index: idx + 1, photo_total: files.length });

        const res = isPublicMode()
          ? await apiCall("public_create_entry", { token, form_type: FORM_TYPE, sha256: sha, file_name: fileName, mime_type: f.type || "image/jpeg", payload: payloadWithIdx })
          : await apiCall("create_entry", { collection_id: cidParam, form_type: FORM_TYPE, sha256: sha, file_name: fileName, mime_type: f.type || "image/jpeg", payload: payloadWithIdx });

        if (res && res.upload_url) await uploadToS3(res.upload_url, f);

        const finalizeAction = isPublicMode() ? "public_finalize_entry" : "finalize_entry";
        await apiCall(finalizeAction, { finalize_token: res.finalize_token, entry_id: res.entry_id });
      }
    }

    $("f").addEventListener("submit", async (e) => {
      e.preventDefault();
        if (typeof __EL_PREVIEW_MODE !== "undefined" && __EL_PREVIEW_MODE) {
          try { showStatus("🔎 Preview Mode: submit disabled", false); } catch(e) {}
          return;
        }

      const btn = $("submitBtn");
      const old = btn.innerHTML;
      btn.disabled = true;
      btn.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> Processing...';
      showStatus("", false);

      try {
        const data = {};
        FIELD_IDS.forEach((id) => {
          const el = $(id);
          if (el) data[id] = (el.value || "").trim();
        });

        if (!data.program_name) throw new Error("कृपया कार्यक्रम चुनें");
        if (!data.reporter_name) throw new Error("कृपया रिपोर्टर नाम भरें");
        if (!data.report_date) throw new Error("कृपया तारीख चुनें");
        if (!data.report_summary) throw new Error("कृपया रिपोर्ट लिखें");

        const level = (data.level || "mandal").toLowerCase();
        validateLocation(level, data);

        if (!isPublicMode() && !cidParam) throw new Error("Missing Collection ID (cid)");

        await submitWithFiles(data);

        $("main-container").classList.add("hidden");
        $("success-screen").classList.remove("hidden");
      } catch (err) {
        showStatus("❌ " + (err.message || "Error"), true);
        btn.disabled = false;
        btn.innerHTML = old;
      }
    });
    </script>

    
// ═══════════════ UNIVERSAL BRANDING v4 ═══════════════
function _elApplyBranding(cfg, formType){
  try{
    const forms=cfg.forms||{}; const ft=forms[formType]||{}; const def=cfg.defaults||cfg.branding||{}; const gl=cfg.global||{};
    const db=def.branding||{};
    const fb=ft.branding||{};
    // Text
    const title=ft.title||db.title||def.title||gl.title||'';
    const sub=ft.subtitle||db.subtitle||def.subtitle||'';
    const tag=ft.tagline||db.tagline||def.tagline||gl.tagline||'';
    const foot=ft.footer_text||db.footer_text||def.footer_text||gl.tagline||'';
    // Assets — check all path variations
    const logoUrl=fb.logo_url||(fb.logo&&fb.logo.url)||ft.logo_url||(db.logo&&db.logo.url)||def.logo_url||'';
    const hdrUrl =fb.header_url||(fb.header&&fb.header.url)||ft.header_url||(db.header&&db.header.url)||def.header_url||'';
    const bgUrl  =fb.background_url||(fb.background&&fb.background.url)||ft.background_url||(db.background&&db.background.url)||def.background_url||'';
    const bgOpa  =(fb.bg_opacity??db.bg_opacity??def.bg_opacity??35)/100;
    // Colors
    const c1=fb.color1||db.color1||def.color1||'';
    const c2=fb.color2||db.color2||def.color2||'';
    // Apply text
    const s=(id)=>document.getElementById(id);
    if(title){['org-name','org-title','brand-title'].forEach(id=>s(id)&&(s(id).textContent=title));}
    if(sub){['org-sub','org-subtitle','brand-subtitle'].forEach(id=>s(id)&&(s(id).textContent=sub));}
    if(tag){['org-tagline','brand-tagline'].forEach(id=>{const el=s(id);if(el){el.textContent=tag;el.style.display='';}}); }
    if(foot){['footer-cam','footer-form','brand-footer'].forEach(id=>s(id)&&(s(id).textContent=foot));}
    // Apply colors
    if(c1) document.documentElement.style.setProperty('--o1',c1);
    if(c2) document.documentElement.style.setProperty('--o2',c2);
    // Apply logo (cache-bust)
    if(logoUrl){
      const ts='?t='+Date.now();
      ['logo-img','brand-logo'].forEach(id=>{const el=s(id);if(el){el.src=logoUrl+ts;el.style.display='block';}});
      ['default-icon','logo-icon'].forEach(id=>s(id)&&(s(id).style.display='none'));
    }
    // Apply header
    if(hdrUrl){
      const ts='?t='+Date.now();
      ['hdr-cam-img','form-hdr-img','brand-header-img'].forEach(id=>{const el=s(id);if(el){el.src=hdrUrl+ts;el.style.display='block';}});
      ['hdr-cam-img-wrap','form-hdr-img-wrap','brand-header-wrap'].forEach(id=>s(id)&&(s(id).style.display='block'));
    }
    // Apply background to body
    if(bgUrl){
      const img=new Image();
      img.onload=()=>{
        document.body.style.backgroundImage='url("'+bgUrl+'?t='+Date.now()+'")';
        document.body.style.backgroundSize='cover';
        document.body.style.backgroundPosition='center';
        document.body.style.backgroundAttachment='fixed';
        // Create/update overlay
        let ov=document.getElementById('_el_bg_ov');
        if(!ov){ov=document.createElement('div');ov.id='_el_bg_ov';ov.style.cssText='position:fixed;inset:0;z-index:0;pointer-events:none;';document.body.prepend(ov);}
        ov.style.background='rgba(15,23,42,'+(1-bgOpa)+')';
      };
      img.src=bgUrl;
    }
    // Fill program options
    const progs=ft.program_options||ft.programs||def.programs||[];
    ['program_name','program_type','karyakram_name'].forEach(selId=>{
      const sel=s(selId);
      if(sel&&progs.length){
        const cur=sel.value;
        const opts=sel.querySelectorAll('option:not([value=""])');
        // Only fill if empty or has placeholder only
        if(opts.length<=1){
          progs.forEach(p=>{ const o=document.createElement('option');o.value=p;o.textContent=p;sel.appendChild(o); });
        }
        if(cur) sel.value=cur;
      }
    });
    // Level lock
    const fixedLevel=ft.fixed_level||'';
    if(fixedLevel){
      ['level','form_level'].forEach(selId=>{
        const sel=s(selId);
        if(sel){ sel.value=fixedLevel; sel.disabled=true; }
      });
    }
  }catch(e){ console.warn('[EL Branding]',e); }
}
// ═════════════════════════════════════════════════════

</body>
    </html>
